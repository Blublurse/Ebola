<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#10b981">
    <title>Task Tracker Pro</title>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlRhc2sgVHJhY2tlciBQcm8iLAogICJzaG9ydF9uYW1lIjogIlRhc2tzIiwKICAiZGVzY3JpcHRpb24iOiAiUHJvZHVjdGl2aXR5IHRhc2sgdHJhY2tlciB3aXRoIGNhbGVuZGFyIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwYTBhMGEiLAogICJ0aGVtZV9jb2xvciI6ICIjMTBiOTgxIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJyUzRSUzQ3JlY3QgZmlsbD0nJTIzMTBiOTgxJyB3aWR0aD0nMTAwJyBoZWlnaHQ9JzEwMCcvJTNFJTNDdGV4dCB4PSc1MCcgeT0nNjAnIGZvbnQtc2l6ZT0nNjAnIHRleHQtYW5jaG9yPSdtaWRkbGUnIGZpbGw9J3doaXRlJyUzRSVFMiU5QyU5MyUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHZpZXdCb3g9JzAgMCAxMDAgMTAwJyUzRSUzQ3JlY3QgZmlsbD0nJTIzMTBiOTgxJyB3aWR0aD0nMTAwJyBoZWlnaHQ9JzEwMCcvJTNFJTNDdGV4dCB4PSc1MCcgeT0nNjAnIGZvbnQtc2l6ZT0nNjAnIHRleHQtYW5jaG9yPSdtaWRkbGUnIGZpbGw9J3doaXRlJyUzRSVFMiU5QyU5MyUzQy90ZXh0JTNFJTNDL3N2ZyUzRSIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Custom scrollbar for mobile */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }
        
        /* Prevent text selection on double-tap */
        .no-select {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Safe area padding for notched devices */
        .safe-area-top {
            padding-top: env(safe-area-inset-top);
        }
        .safe-area-bottom {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Color themes
        const themes = {
          mint: {
            primary: '#10b981',
            primaryHover: '#059669',
            primaryLight: '#d1fae5',
            primaryDark: '#064e3b',
            accent: '#34d399',
            shadow: 'rgba(16, 185, 129, 0.3)',
          },
          neonPink: {
            primary: '#ec4899',
            primaryHover: '#db2777',
            primaryLight: '#fce7f3',
            primaryDark: '#831843',
            accent: '#f472b6',
            shadow: 'rgba(236, 72, 153, 0.3)',
          },
          orange: {
            primary: '#f97316',
            primaryHover: '#ea580c',
            primaryLight: '#ffedd5',
            primaryDark: '#7c2d12',
            accent: '#fb923c',
            shadow: 'rgba(249, 115, 22, 0.3)',
          },
          purple: {
            primary: '#a855f7',
            primaryHover: '#9333ea',
            primaryLight: '#f3e8ff',
            primaryDark: '#581c87',
            accent: '#c084fc',
            shadow: 'rgba(168, 85, 247, 0.3)',
          },
          cyan: {
            primary: '#06b6d4',
            primaryHover: '#0891b2',
            primaryLight: '#cffafe',
            primaryDark: '#164e63',
            accent: '#22d3ee',
            shadow: 'rgba(6, 182, 212, 0.3)',
          },
          rose: {
            primary: '#f43f5e',
            primaryHover: '#e11d48',
            primaryLight: '#ffe4e6',
            primaryDark: '#881337',
            accent: '#fb7185',
            shadow: 'rgba(244, 63, 94, 0.3)',
          },
        };

        // Icons
        const Calendar = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Plus = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Check = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" strokeWidth="3">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const Trash2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const Clock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const Sun = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        );

        const Moon = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
        );

        const Palette = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <circle cx="15.5" cy="8.5" r="1.5"></circle>
                <circle cx="12" cy="15.5" r="1.5"></circle>
            </svg>
        );

        const ChevronLeft = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        );

        const ChevronRight = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );

        function ProductivityTaskTracker() {
          const [darkMode, setDarkMode] = useState(() => {
            const saved = localStorage.getItem('darkMode');
            return saved ? JSON.parse(saved) : true;
          });

          const [colorTheme, setColorTheme] = useState(() => {
            const saved = localStorage.getItem('colorTheme');
            return saved || 'mint';
          });

          const [showThemeSelector, setShowThemeSelector] = useState(false);
          const [showTaskPanel, setShowTaskPanel] = useState(false);
          
          const [tasks, setTasks] = useState(() => {
            const saved = localStorage.getItem('tasks');
            return saved ? JSON.parse(saved) : {};
          });
          
          const [selectedDate, setSelectedDate] = useState(new Date());
          const [newTask, setNewTask] = useState('');
          const [newTaskTime, setNewTaskTime] = useState('');
          const [newTaskPriority, setNewTaskPriority] = useState('medium');
          const [currentMonth, setCurrentMonth] = useState(new Date());
          const [isMobile, setIsMobile] = useState(window.innerWidth < 1024);

          const theme = themes[colorTheme];
          const taskPanelRef = useRef(null);

          useEffect(() => {
            const handleResize = () => {
              setIsMobile(window.innerWidth < 1024);
            };
            window.addEventListener('resize', handleResize);
            return () => window.removeEventListener('resize', handleResize);
          }, []);

          useEffect(() => {
            localStorage.setItem('tasks', JSON.stringify(tasks));
          }, [tasks]);

          useEffect(() => {
            localStorage.setItem('darkMode', JSON.stringify(darkMode));
          }, [darkMode]);

          useEffect(() => {
            localStorage.setItem('colorTheme', colorTheme);
            document.querySelector('meta[name="theme-color"]').setAttribute('content', theme.primary);
          }, [colorTheme, theme.primary]);

          // Close theme selector when clicking outside
          useEffect(() => {
            const handleClickOutside = (e) => {
              if (showThemeSelector && !e.target.closest('.theme-selector-container')) {
                setShowThemeSelector(false);
              }
            };
            document.addEventListener('mousedown', handleClickOutside);
            document.addEventListener('touchstart', handleClickOutside);
            return () => {
              document.removeEventListener('mousedown', handleClickOutside);
              document.removeEventListener('touchstart', handleClickOutside);
            };
          }, [showThemeSelector]);

          // Notifications
          useEffect(() => {
            const checkOverdue = () => {
              const now = new Date();
              const today = formatDate(now);
              const currentTime = now.getHours() * 60 + now.getMinutes();

              Object.keys(tasks).forEach(dateKey => {
                tasks[dateKey].forEach(task => {
                  if (task.time && !task.completed && !task.notified) {
                    const taskDate = new Date(dateKey);
                    const taskDateTime = formatDate(taskDate);
                    
                    if (taskDateTime === today) {
                      const [hours, minutes] = task.time.split(':');
                      const taskTime = parseInt(hours) * 60 + parseInt(minutes);
                      
                      if (currentTime >= taskTime) {
                        if (Notification.permission === 'granted') {
                          new Notification('Task Due!', {
                            body: `${task.text} - ${task.priority.toUpperCase()} priority`,
                            icon: '⏰'
                          });
                        }
                        setTasks(prev => ({
                          ...prev,
                          [dateKey]: prev[dateKey].map(t => 
                            t.id === task.id ? { ...t, notified: true } : t
                          )
                        }));
                      }
                    }
                  }
                });
              });
            };

            if (Notification.permission === 'default') {
              Notification.requestPermission();
            }

            const interval = setInterval(checkOverdue, 60000);
            checkOverdue();

            return () => clearInterval(interval);
          }, [tasks]);

          const daysInMonth = (date) => {
            return new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
          };

          const firstDayOfMonth = (date) => {
            return new Date(date.getFullYear(), date.getMonth(), 1).getDay();
          };

          const formatDate = (date) => {
            return date.toISOString().split('T')[0];
          };

          const addTask = () => {
            if (newTask.trim()) {
              const dateKey = formatDate(selectedDate);
              setTasks({
                ...tasks,
                [dateKey]: [...(tasks[dateKey] || []), { 
                  id: Date.now(), 
                  text: newTask, 
                  completed: false,
                  priority: newTaskPriority,
                  time: newTaskTime || null,
                  notified: false
                }]
              });
              setNewTask('');
              setNewTaskTime('');
              setNewTaskPriority('medium');
            }
          };

          const toggleTask = (dateKey, taskId) => {
            setTasks({
              ...tasks,
              [dateKey]: tasks[dateKey].map(task =>
                task.id === taskId ? { ...task, completed: !task.completed } : task
              )
            });
          };

          const deleteTask = (dateKey, taskId) => {
            setTasks({
              ...tasks,
              [dateKey]: tasks[dateKey].filter(task => task.id !== taskId)
            });
          };

          const changeMonth = (offset) => {
            setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + offset, 1));
          };

          const handleDateSelect = (date) => {
            setSelectedDate(date);
            if (isMobile) {
              setShowTaskPanel(true);
            }
          };

          const getPriorityColor = (priority, completed = false) => {
            if (completed) return darkMode ? 'bg-gray-700' : 'bg-gray-200';
            
            switch(priority) {
              case 'high':
                return darkMode ? 'bg-red-900/40 border-red-500/50' : 'bg-red-100 border-red-300';
              case 'medium':
                return darkMode ? 'bg-yellow-900/40 border-yellow-500/50' : 'bg-yellow-100 border-yellow-300';
              case 'low':
                return darkMode ? 'bg-blue-900/40 border-blue-500/50' : 'bg-blue-100 border-blue-300';
              default:
                return darkMode ? 'bg-gray-800' : 'bg-gray-100';
            }
          };

          const getPriorityDot = (priority) => {
            switch(priority) {
              case 'high': return 'bg-red-500';
              case 'medium': return 'bg-yellow-500';
              case 'low': return 'bg-blue-500';
              default: return 'bg-gray-500';
            }
          };

          const isOverdue = (task, dateKey) => {
            if (!task.time || task.completed) return false;
            
            const now = new Date();
            const taskDate = new Date(dateKey);
            const today = formatDate(now);
            const taskDateTime = formatDate(taskDate);
            
            if (taskDateTime < today) return true;
            if (taskDateTime === today) {
              const [hours, minutes] = task.time.split(':');
              const taskTime = parseInt(hours) * 60 + parseInt(minutes);
              const currentTime = now.getHours() * 60 + now.getMinutes();
              return currentTime > taskTime;
            }
            return false;
          };

          const renderCalendar = () => {
            const days = [];
            const totalDays = daysInMonth(currentMonth);
            const firstDay = firstDayOfMonth(currentMonth);
            const today = new Date();
            
            for (let i = 0; i < firstDay; i++) {
              days.push(<div key={`empty-${i}`} className="aspect-square"></div>);
            }

            for (let day = 1; day <= totalDays; day++) {
              const date = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
              const dateKey = formatDate(date);
              const isSelected = formatDate(selectedDate) === dateKey;
              const isToday = formatDate(today) === dateKey;
              const dayTasks = tasks[dateKey] || [];
              const completedCount = dayTasks.filter(t => t.completed).length;
              const highPriorityCount = dayTasks.filter(t => !t.completed && t.priority === 'high').length;

              days.push(
                <div
                  key={day}
                  onClick={() => handleDateSelect(date)}
                  style={isSelected ? {
                    backgroundColor: theme.primary,
                    boxShadow: `0 10px 25px ${theme.shadow}`
                  } : {}}
                  className={`no-select aspect-square p-1.5 sm:p-2 rounded-lg cursor-pointer transition-all active:scale-95 ${
                    isSelected
                      ? 'text-white'
                      : isToday
                      ? darkMode ? 'bg-gray-800 border-2' : 'bg-gray-100 border-2'
                      : darkMode ? 'bg-gray-800/50 hover:bg-gray-700/50 border border-gray-700' : 'bg-white hover:bg-gray-50 border border-gray-200'
                  }`}
                  {...(!isSelected && isToday && { style: { borderColor: theme.primary } })}
                >
                  <div className="text-xs sm:text-sm font-semibold mb-0.5 sm:mb-1">{day}</div>
                  {dayTasks.length > 0 && (
                    <div className="flex flex-col gap-0.5">
                      <div className={`text-xs ${isSelected ? 'text-white' : darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                        {completedCount}/{dayTasks.length}
                      </div>
                      <div className="flex gap-0.5 flex-wrap">
                        {dayTasks.slice(0, isMobile ? 2 : 4).map(task => (
                          <div
                            key={task.id}
                            className={`w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full ${
                              task.completed ? 'bg-green-500' : getPriorityDot(task.priority)
                            }`}
                          ></div>
                        ))}
                      </div>
                      {highPriorityCount > 0 && (
                        <div className="text-xs text-red-500 font-semibold">
                          !{highPriorityCount}
                        </div>
                      )}
                    </div>
                  )}
                </div>
              );
            }

            return days;
          };

          const selectedDateKey = formatDate(selectedDate);
          const selectedTasks = (tasks[selectedDateKey] || []).sort((a, b) => {
            const priorityOrder = { high: 0, medium: 1, low: 2 };
            if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
              return priorityOrder[a.priority] - priorityOrder[b.priority];
            }
            if (a.time && b.time) return a.time.localeCompare(b.time);
            if (a.time) return -1;
            if (b.time) return 1;
            return 0;
          });

          const TaskPanel = () => (
            <div className={`${
              isMobile 
                ? `fixed inset-0 z-50 transform transition-transform duration-300 ${showTaskPanel ? 'translate-y-0' : 'translate-y-full'}` 
                : 'lg:col-span-1'
            }`}>
              <div 
                ref={taskPanelRef}
                className={`rounded-t-2xl lg:rounded-2xl p-4 sm:p-6 h-full overflow-y-auto safe-area-bottom ${
                  darkMode 
                    ? 'bg-gray-800/95 backdrop-blur-xl border-t lg:border border-gray-700/50' 
                    : 'bg-white/95 backdrop-blur-xl border-t lg:border border-gray-200 shadow-xl'
                } ${isMobile ? '' : 'lg:sticky lg:top-6'}`}
              >
                {isMobile && (
                  <div className="flex justify-center mb-3">
                    <div className={`w-12 h-1 rounded-full ${darkMode ? 'bg-gray-600' : 'bg-gray-300'}`}></div>
                  </div>
                )}

                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-lg sm:text-xl font-bold" style={{ color: theme.primary }}>
                    {selectedDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                  </h3>
                  {isMobile && (
                    <button
                      onClick={() => setShowTaskPanel(false)}
                      className="p-2 rounded-lg"
                      style={{ color: theme.primary }}
                    >
                      <ChevronLeft className="w-6 h-6" />
                    </button>
                  )}
                </div>

                <div className="space-y-3 mb-6">
                  <input
                    type="text"
                    value={newTask}
                    onChange={(e) => setNewTask(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && addTask()}
                    placeholder="What needs to be done?"
                    className={`w-full px-4 py-3 rounded-xl text-base ${
                      darkMode 
                        ? 'bg-gray-700/50 border-gray-600 text-white placeholder-gray-400' 
                        : 'bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-500'
                    } border focus:outline-none focus:ring-2`}
                    style={{ '--tw-ring-color': theme.primary }}
                    onFocus={(e) => e.target.style.borderColor = theme.primary}
                    onBlur={(e) => e.target.style.borderColor = ''}
                  />
                  
                  <div className="flex gap-2">
                    <input
                      type="time"
                      value={newTaskTime}
                      onChange={(e) => setNewTaskTime(e.target.value)}
                      className={`flex-1 px-3 py-2.5 rounded-xl text-sm ${
                        darkMode 
                          ? 'bg-gray-700/50 border-gray-600 text-white' 
                          : 'bg-gray-50 border-gray-300 text-gray-900'
                      } border focus:outline-none focus:ring-2`}
                      onFocus={(e) => e.target.style.borderColor = theme.primary}
                      onBlur={(e) => e.target.style.borderColor = ''}
                    />
                    
                    <select
                      value={newTaskPriority}
                      onChange={(e) => setNewTaskPriority(e.target.value)}
                      className={`flex-1 px-3 py-2.5 rounded-xl text-sm ${
                        darkMode 
                          ? 'bg-gray-700/50 border-gray-600 text-white' 
                          : 'bg-gray-50 border-gray-300 text-gray-900'
                      } border focus:outline-none focus:ring-2`}
                      onFocus={(e) => e.target.style.borderColor = theme.primary}
                      onBlur={(e) => e.target.style.borderColor = ''}
                    >
                      <option value="low">Low</option>
                      <option value="medium">Medium</option>
                      <option value="high">High</option>
                    </select>
                  </div>

                  <button
                    onClick={addTask}
                    className="w-full px-4 py-3 text-white rounded-xl transition-all font-medium shadow-lg active:scale-95"
                    style={{ 
                      backgroundColor: theme.primary,
                      boxShadow: `0 4px 14px ${theme.shadow}`
                    }}
                    onTouchStart={(e) => e.currentTarget.style.backgroundColor = theme.primaryHover}
                    onTouchEnd={(e) => e.currentTarget.style.backgroundColor = theme.primary}
                  >
                    <Plus className="w-5 h-5 inline mr-2" />
                    Add Task
                  </button>
                </div>

                <div className="space-y-2 max-h-[50vh] lg:max-h-96 overflow-y-auto">
                  {selectedTasks.length === 0 ? (
                    <p className={`text-center py-8 ${darkMode ? 'text-gray-500' : 'text-gray-400'}`}>
                      No tasks for this day
                    </p>
                  ) : (
                    selectedTasks.map(task => (
                      <div
                        key={task.id}
                        className={`flex items-start gap-3 p-3 rounded-xl border ${
                          getPriorityColor(task.priority, task.completed)
                        } transition-all`}
                      >
                        <button
                          onClick={() => toggleTask(selectedDateKey, task.id)}
                          className={`flex-shrink-0 w-6 h-6 sm:w-5 sm:h-5 rounded-md border-2 flex items-center justify-center mt-0.5 active:scale-90 ${
                            task.completed
                              ? 'bg-green-500 border-green-500'
                              : darkMode ? 'border-gray-500' : 'border-gray-400'
                          }`}
                        >
                          {task.completed && <Check className="w-4 h-4 sm:w-3 sm:h-3 text-white" />}
                        </button>
                        
                        <div className="flex-1 min-w-0">
                          <div className={`font-medium text-sm sm:text-base ${task.completed ? 'line-through opacity-50' : ''}`}>
                            {task.text}
                          </div>
                          <div className="flex items-center gap-2 mt-1 flex-wrap">
                            {task.time && (
                              <span className={`text-xs flex items-center gap-1 ${
                                isOverdue(task, selectedDateKey)
                                  ? 'text-red-500 font-semibold'
                                  : darkMode ? 'text-gray-400' : 'text-gray-600'
                              }`}>
                                <Clock className="w-3 h-3" />
                                {task.time}
                                {isOverdue(task, selectedDateKey) && (
                                  <AlertCircle className="w-3 h-3" />
                                )}
                              </span>
                            )}
                            <span className={`text-xs px-2 py-0.5 rounded-full ${
                              task.priority === 'high' 
                                ? 'bg-red-500/20 text-red-400 border border-red-500/30' 
                                : task.priority === 'medium'
                                ? 'bg-yellow-500/20 text-yellow-400 border border-yellow-500/30'
                                : 'bg-blue-500/20 text-blue-400 border border-blue-500/30'
                            }`}>
                              {task.priority.toUpperCase()}
                            </span>
                          </div>
                        </div>

                        <button
                          onClick={() => deleteTask(selectedDateKey, task.id)}
                          className={`flex-shrink-0 p-2 rounded-lg transition-colors active:scale-90 ${
                            darkMode ? 'hover:bg-gray-600/50' : 'hover:bg-gray-200'
                          }`}
                        >
                          <Trash2 className="w-4 h-4 text-red-500" />
                        </button>
                      </div>
                    ))
                  )}
                </div>
              </div>
            </div>
          );

          return (
            <div className={`min-h-screen transition-colors safe-area-top ${
              darkMode 
                ? 'bg-gray-950 text-white' 
                : 'bg-gray-50 text-gray-900'
            }`}>
              <div className="max-w-7xl mx-auto p-3 sm:p-6 pb-20 lg:pb-6">
                {/* Header */}
                <div className="flex items-center justify-between mb-4 sm:mb-8">
                  <div className="flex items-center gap-2 sm:gap-3">
                    <div className="p-1.5 sm:p-2 rounded-xl" style={{ backgroundColor: theme.primary }}>
                      <Calendar className="w-6 h-6 sm:w-8 sm:h-8 text-white" />
                    </div>
                    <div>
                      <h1 className="text-xl sm:text-3xl font-bold" style={{ color: theme.primary }}>
                        Task Tracker {!isMobile && 'Pro'}
                      </h1>
                      {!isMobile && (
                        <p className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                          Stay organized, stay productive
                        </p>
                      )}
                    </div>
                  </div>
                  
                  <div className="flex gap-1.5 sm:gap-2">
                    <div className="relative theme-selector-container">
                      <button
                        onClick={() => setShowThemeSelector(!showThemeSelector)}
                        className={`p-2 sm:p-3 rounded-xl transition-all active:scale-90 ${
                          darkMode 
                            ? 'bg-gray-800/50 hover:bg-gray-700/50 border border-gray-700' 
                            : 'bg-white hover:bg-gray-50 border border-gray-200 shadow-sm'
                        }`}
                        style={{ borderColor: showThemeSelector ? theme.primary : undefined }}
                      >
                        <Palette className="w-4 h-4 sm:w-5 sm:h-5" style={{ color: theme.primary }} />
                      </button>
                      
                      {showThemeSelector && (
                        <div className={`absolute right-0 mt-2 p-3 rounded-xl shadow-xl z-50 ${
                          darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'
                        }`}>
                          <div className="grid grid-cols-3 gap-2">
                            {Object.keys(themes).map(themeName => (
                              <button
                                key={themeName}
                                onClick={() => {
                                  setColorTheme(themeName);
                                  setShowThemeSelector(false);
                                }}
                                className="w-8 h-8 sm:w-10 sm:h-10 rounded-lg transition-transform active:scale-90"
                                style={{ 
                                  backgroundColor: themes[themeName].primary,
                                  border: colorTheme === themeName ? '3px solid white' : 'none',
                                  boxShadow: colorTheme === themeName ? `0 0 10px ${themes[themeName].shadow}` : 'none'
                                }}
                                title={themeName.charAt(0).toUpperCase() + themeName.slice(1)}
                              />
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                    
                    <button
                      onClick={() => setDarkMode(!darkMode)}
                      className={`p-2 sm:p-3 rounded-xl transition-all active:scale-90 ${
                        darkMode 
                          ? 'bg-gray-800/50 hover:bg-gray-700/50 border border-gray-700' 
                          : 'bg-white hover:bg-gray-50 border border-gray-200 shadow-sm'
                      }`}
                    >
                      {darkMode ? (
                        <Sun className="w-4 h-4 sm:w-5 sm:h-5 text-yellow-500" />
                      ) : (
                        <Moon className="w-4 h-4 sm:w-5 sm:h-5" style={{ color: theme.primary }} />
                      )}
                    </button>
                  </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                  {/* Calendar */}
                  <div className="lg:col-span-2">
                    <div className={`rounded-2xl p-3 sm:p-6 ${
                      darkMode 
                        ? 'bg-gray-800/30 backdrop-blur-xl border border-gray-700/50' 
                        : 'bg-white/80 backdrop-blur-xl border border-gray-200 shadow-xl'
                    }`}>
                      {/* Month Navigation */}
                      <div className="flex items-center justify-between mb-4 sm:mb-6">
                        <button
                          onClick={() => changeMonth(-1)}
                          className={`p-2 sm:px-4 sm:py-2 rounded-xl font-medium transition-all active:scale-90 ${
                            darkMode 
                              ? 'bg-gray-700/50 hover:bg-gray-600/50 border border-gray-600' 
                              : 'bg-gray-100 hover:bg-gray-200 border border-gray-300'
                          }`}
                        >
                          <ChevronLeft className="w-5 h-5 sm:hidden" />
                          <span className="hidden sm:inline">←</span>
                        </button>
                        <h2 className="text-lg sm:text-2xl font-bold">
                          {currentMonth.toLocaleDateString('en-US', { month: isMobile ? 'short' : 'long', year: 'numeric' })}
                        </h2>
                        <button
                          onClick={() => changeMonth(1)}
                          className={`p-2 sm:px-4 sm:py-2 rounded-xl font-medium transition-all active:scale-90 ${
                            darkMode 
                              ? 'bg-gray-700/50 hover:bg-gray-600/50 border border-gray-600' 
                              : 'bg-gray-100 hover:bg-gray-200 border border-gray-300'
                          }`}
                        >
                          <ChevronRight className="w-5 h-5 sm:hidden" />
                          <span className="hidden sm:inline">→</span>
                        </button>
                      </div>

                      {/* Day Labels */}
                      <div className="grid grid-cols-7 gap-1 sm:gap-2 mb-2">
                        {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((day, idx) => (
                          <div key={idx} className={`text-center text-xs sm:text-sm font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>
                            {isMobile ? day : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'][idx]}
                          </div>
                        ))}
                      </div>

                      {/* Calendar Grid */}
                      <div className="grid grid-cols-7 gap-1 sm:gap-2">
                        {renderCalendar()}
                      </div>
                    </div>
                  </div>

                  {/* Task Panel - Desktop */}
                  {!isMobile && <TaskPanel />}
                </div>
              </div>

              {/* Task Panel - Mobile Slide-up */}
              {isMobile && <TaskPanel />}

              {/* Mobile FAB to open tasks */}
              {isMobile && !showTaskPanel && selectedTasks.length > 0 && (
                <button
                  onClick={() => setShowTaskPanel(true)}
                  className="fixed bottom-6 right-6 p-4 rounded-full text-white shadow-2xl z-40 active:scale-90 transition-transform"
                  style={{ 
                    backgroundColor: theme.primary,
                    boxShadow: `0 10px 30px ${theme.shadow}`
                  }}
                >
                  <div className="flex items-center gap-2">
                    <Calendar className="w-6 h-6" />
                    <span className="font-bold">{selectedTasks.length}</span>
                  </div>
                </button>
              )}
            </div>
          );
        }

        ReactDOM.render(<ProductivityTaskTracker />, document.getElementById('root'));
    </script>
</body>
</html>